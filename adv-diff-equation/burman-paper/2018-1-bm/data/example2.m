function data=example2

global b
a_1=1;a_2=0;e=10^(-5); 

%例子2中的数据
data.g=@g;data.a=@a;data.f=@f;data.u_x=@u_x;data.u_y=@u_y;data.u=@u;

function r = u(x,~)

% r=exp(-(x-0.5).^2/0.2-3*(y-0.5).^2/0.2);
 
r=1/2*(1-tanh((x-0.5)/0.05));
% f=@(x,y)exp(-(x-0.5).^2/0.2-3*(y-0.5).^2/0.2);
% ezmesh(f,[0,1],[0,1])
% 
% f=@(x,y)1/2*(1-tanh((x-0.5)/0.05));
% ezmesh(f,[0,1],[0,1])
end
function r=a(~,~)

r=1;
end

function r=f(x,~)

% r=b*exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2) - e*(exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2).*(10*x - 5).^2 - 40*exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2) + exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2).*(30*y - 15).^2) - a_1*exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2).*(10*x - 5) - a_2*exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2).*(30*y - 15);

r=a_1*(10*tanh(20*x - 10).^2 - 10) - b*(tanh(20*x - 10)/2 - 1/2) + 20*e*tanh(20*x - 10).*(20*tanh(20*x - 10).^2 - 20);
end

function r=g(x,y)
% 
% if (y==0 && 0<=x && x<1) || (y==1 && 0<x && x<=1)
%     r=exp(-(x-0.5).^2/0.2-15/4);
% elseif (x==1 && 0<=y && y<1) || (x==0 && 0<y && y<=1)
%     r=exp(-3*(y-0.5).^2/0.2-5/4);
% end
% end

if (y==0 && 0<=x && x<1) || (y==1 && 0<x && x<=1)
    r=1/2*(1-tanh((x-0.5)/0.05));
elseif x==1 && 0<=y && y<1
    r=1/2*(1-tanh(10));
elseif x==0 && 0<y && y<=1
    r=1/2*(1-tanh(-10));
end
end

function r = u_x(x,~)

% r=-exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2).*(10*x - 5);

r=10*tanh(20*x - 10).^2 - 10;

end

function r = u_y(~,~)

% r=-exp(- 5*(x - 1/2).^2 - 15*(y - 1/2).^2).*(30*y - 15);

r=0;
end
end

